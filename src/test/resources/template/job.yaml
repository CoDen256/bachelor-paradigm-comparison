apiVersion: batch/v1
kind: Job
metadata:
  namespace: client-test
  name: ${NAME}
spec:
  ttlSecondsAfterFinished: ${TTL}
  backoffLimit: 0
  template:
    spec:
      containers:
        - name: main
          image: busybox:latest
          command: [ "/bin/sh" ]
          args: [ "-c", "echo start && sleep ${SLEEP} && echo slept ${SLEEP} && echo end && exit ${CODE}" ]
          volumeMounts:
            - mountPath: /vol
              name: dir
      restartPolicy: Never
      volumes:
        - name: dir
          emptyDir: {}
